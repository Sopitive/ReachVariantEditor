<!doctype html>
<html lang="en">
   <head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<meta name="viewport" content="width=device-width">
<link rel="icon" type="image/x-icon" href="resources/favicon.ico">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script src="https://sopitive.github.io/highlightjs-rvt-script/dist/rvt-script.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
      <meta charset="UTF-8" />
      <title>User-defined functions | ReachVariantTool Documentation</title>
      <base href="../" />
      <link rel="stylesheet" href="resources/main.css" />
      <noscript>
         <link rel="stylesheet" href="resources/noscript.css" />
      </noscript>
      <script src="resources/head.js"></script>
   </head>
   <body>
<div class="scrollbar"></div>
<div class="header">
        <div class="dropdown">
            MCC Gametypers<i class="fa fa-caret-down"></i>
            <ul class="dropdown-content">
                <a class="dropdown-item" target="_blank" href="https://discord.gg/Z2ZvPsCbcc"><li>Discord</li></a>
            </ul>
            
        </div>
        <div class="dropdown">
            The Anvil<i class="fa fa-caret-down"></i>
            <ul class="dropdown-content">
                <a class="dropdown-item" target="_blank" href="https://discord.gg/kVN58A2ydm"><li>Discord</li></a>
                <a class="dropdown-item" target="_blank" href="https://theanvil.net/forums/"><li>Forums</li></a>
                <a class="dropdown-item" target="_blank" href="https://theanvil.net/maps/"><li>Maps</li></a>
                <a class="dropdown-item" target="_blank" href="https://theanvil.net/mods/"><li>Mods</li></a>
            </ul>
            
        </div>
        <div class="dropdown">
            Halo Customs<i class="fa fa-caret-down"></i>
            <ul class="dropdown-content">
                <a class="dropdown-item" target="_blank" href="https://halocustoms.com/discord"><li>Discord</li></a>
                <a class="dropdown-item" target="_blank" href="https://halocustoms.com/maps/"><li>Maps</li></a>
                <a class="dropdown-item" target="_blank" href="https://halocustoms.com/"><li>Forums</li></a>
                <a class="dropdown-item" target="_blank" href="https://www.reddit.com/r/HaloCustoms/"><li>Reddit</li></a>
                <a class="dropdown-item" target="_blank" href="https://halocustoms.com/maps/categories/gametypes.40/"><li>Gametypes</li></a>            </ul>
            
        </div>
        <div class="dropdown">
            Halo Mods<i class="fa fa-caret-down"></i>
            <ul class="dropdown-content">
                <a class="dropdown-item" target="_blank" href="https://discord.gg/halomods"><li>Discord</li></a>
                <a class="dropdown-item" target="_blank" href="https://www.reddit.com/r/halomods/"><li>Reddit</li></a>
                
            </ul>
        </div>
        <div class="dropdown fa fa-adjust">
            <div class="dropdown-content">
                <input id="dark-mode" name="dark-mode" type="checkbox">
                <label for="dark-mode">Dark Mode</label>
            </div>
        </div>
    </div>
      <nav id="sidebar">
         <ul>
            <li><a href="index.html">Index</a></li>
            <li>
               <a>Main Window</a>
               <ul>
                  <li>
                     <a href="editor/main_window/index.html">Multiplayer</a>
                     <ul>
                        <li><a href="editor/main_window/metadata.html">Metadata</a></li>
                        <li><a href="editor/main_window/options-general.html">General Settings</a></li>
                        <li><a href="editor/main_window/options-respawn.html">Respawn Settings</a></li>
                        <li><a href="editor/main_window/options-social.html">Social Settings</a></li>
                        <li><a href="editor/main_window/options-map.html">Map and Game Settings</a></li>
                        <li data-dont-default-collapse>
                           <a href="editor/main_window/options-team.html">Team Settings</a>
                           <ul>
                              <li><a href="editor/main_window/options-team-specific.html">Individual Team Settings</a></li>
                           </ul>
                        </li>
                        <li data-dont-default-collapse>
                           <a href="editor/main_window/options-loadout.html">Loadout Settings</a>
                           <ul>
                              <li><a href="editor/main_window/options-loadout-specific.html">Individual Loadout Settings</a></li>
                           </ul>
                        </li>
                        <li><a href="editor/main_window/options-megalo.html">Script-Specific Settings</a></li>
                        <li><a href="editor/main_window/option-visibility.html">Option Visibility</a></li>
                        <li><a href="editor/main_window/tu1.html">Title Update Settings</a></li>
                        <li><a href="editor/main_window/traits.html">(all player traits)</a></li>
                        <li><a href="editor/main_window/forge.html">Forge Settings</a></li>
                     </ul>
                  </li>
                  <li>
                     <a href="editor/main_window_ff/index.html">Firefight</a>
                     <ul>
                        <li><a href="editor/main_window_ff/metadata.html">Metadata</a></li>
                        <li>
                           <a href="editor/main_window_ff/scenario.html">Firefight Settings</a>
                           <ul>
                              <li><a href="editor/main_window_ff/lives.html">Player Lives</a></li>
                              <li><a href="editor/main_window_ff/options-respawn.html">Respawn Settings</a></li>
                              <li><a href="editor/main_window_ff/round.html">Round Settings</a></li>
                              <li><a href="editor/main_window_ff/bonus-wave.html">Bonus Wave Settings</a></li>
                              <li><a href="editor/main_window_ff/custom-skull.html">Custom Skulls</a></li>
                           </ul>
                        </li>
                        <li>
                           <a>Other Settings</a>
                           <ul>
                              <li><a href="editor/main_window_ff/options-general.html">General Settings</a></li>
                              <li><a href="editor/main_window_ff/options-social.html">Social Settings</a></li>
                              <li data-dont-default-collapse>
                                 <a href="editor/main_window_ff/options-team.html">Team Settings</a>
                                 <ul>
                                    <li><a href="editor/main_window_ff/options-team-specific.html">Individual Team Settings</a></li>
                                 </ul>
                              </li>
                              <li data-dont-default-collapse>
                                 <a href="editor/main_window_ff/options-loadout.html">Loadout Settings</a>
                                 <ul>
                                    <li><a href="editor/main_window_ff/options-loadout-specific.html">Individual Loadout Settings</a></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li><a href="editor/main_window_ff/traits.html">(all player traits)</a></li>
                        <li><a href="editor/main_window_ff/traits-wave.html">(all wave traits)</a></li>
                     </ul>
                  </li>
               </ul>
            </li>
            <li>
               <a href="editor/script_window/index.html">Script Window</a>
               <ul>
                  <li><a href="editor/script_window/meta-strings.html">Metadata Strings</a></li>
                  <li>
                     <a href="editor/script_window/string-table.html">All Other Strings</a>
                     <ul>
                        <li><a href="editor/script_window/string-localization.html">Localization</a></li>
                     </ul>
                  </li>
                  <li><a href="editor/script_window/forge-labels.html">Forge Labels</a></li>
                  <li><a href="editor/script_window/map-permissions.html">Map Permissions</a></li>
                  <li><a href="editor/script_window/player-rating-parameters.html">Player Rating Parameters</a></li>
                  <li><a href="editor/script_window/required-object-types.html">Required Object Types</a></li>
                  <li><a href="editor/script_window/script-options.html">Scripted Options</a></li>
                  <li><a href="editor/script_window/script-traits.html">Scripted Traits</a></li>
                  <li><a href="editor/script_window/script-stats.html">Scripted Stats</a></li>
                  <li><a href="editor/script_window/script-widgets.html">Scripted Widgets</a></li>
                  <li><a href="editor/script_window/gametype-code.html">Gametype Code</a></li>
               </ul>
            </li>
            <li>
               <a href="script/syntax.html">Scripting Language</a>
               <ul>
                  <li><a href="script/alias.html">Aliases</a></li>
                  <li><a href="script/events.html">Events</a></li>
                  <li><a href="script/for.html">For-each-loops</a></li>
                  <li><a href="script/if.html">If-/alt-statements</a></li>
                  <li><a href="script/operators.html">Operators</a></li>
                  <li><a href="script/string-special-chars.html">Special string characters</a></li>
                  <li><a href="script/enum.html">User-defined enums</a></li>
                  <li><a href="script/function.html">User-defined functions</a></li>
                  <li><a href="script/snippets.html">Useful code snippets</a></li>
                  <li><a href="script/declare.html">Variable declarations</a></li>
                  <li><a href="script/best-practices.html">Best practices</a></li>
               </ul>
            </li>
            <li>
               <a href="script/api/index.html">Script API reference</a>
               <ul>
                  <li data-dont-default-collapse>
                     <a>Namespaces</a>
                     <ul>
                        <li><a href="script/api/ns_unnamed.html">Content not in any namespace</a></li>
                        <li><a href="script/api/ns_enums.html">enums</a></li>
                        <li><a href="script/api/ns_game.html">game</a></li>
                        <li><a href="script/api/ns_global.html">global</a></li>
                     </ul>
                  </li>
                  <li data-dont-default-collapse>
                     <a>Types</a>
                     <ul>
                        <li data-dont-default-collapse>
                           <a>Variables</a>
                           <ul>
                              <li><a href="script/api/number.html">Number</a></li>
                              <li><a href="script/api/object.html">Object</a></li>
                              <li><a href="script/api/player.html">Player</a></li>
                              <li><a href="script/api/team.html">Team</a></li>
                              <li><a href="script/api/timer.html">Timer</a></li>
                           </ul>
                        </li>
                        <li data-dont-default-collapse>
                           <a>Misc</a>
                           <ul>
                              <li><a href="script/api/bool.html">Bool</a></li>
                              <li><a href="script/api/engine-icon.html">Engine Icon</a></li>
                              <li><a href="script/api/forge-label.html">Forge Label</a></li>
                              <li><a href="script/api/format-string.html">Format String</a></li>
                              <li><a href="script/api/incident.html">Incident</a></li>
                              <li><a href="script/api/object-type.html">Object Type</a></li>
                              <li><a href="script/api/player-set.html">Player Set</a></li>
                              <li><a href="script/api/player-traits.html">Player Traits</a></li>
                              <li><a href="script/api/sound.html">Sound</a></li>
                              <li><a href="script/api/variant-string-id.html">Variant ID</a></li>
                              <li><a href="script/api/waypoint-icon.html">Waypoint Icon</a></li>
                              <li><a href="script/api/widget.html">Widget</a></li>
                              <li><a href="script/api/widget-icon.html">Widget Icon</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
               </ul>
            </li>
            <li>
               <a>Concepts</a>
               <ul>
                  <li><a href="concepts/bipeds-and-items.html">Bipeds and items</a></li>
                  <li><a href="concepts/firefight.html">Firefight</a></li>
               </ul>
            </li>
         </ul>
      </nav>
      <main>
         <h1>User-defined functions</h1>
      <p>
         Megalo's bytecode supports <dfn>user-defined functions</dfn>: reusable pieces of 
         script code that can be "called" from multiple different locations. User-defined 
         functions are useful for avoiding code duplication, if you have tasks that need 
         to be performed consistently at different points in your script; they are also a 
         good way to repeat tasks.
      </p>
      <p>
         User-defined functions run with the "environment" of their caller. For example, 
         a user-defined function called from inside of a <a href="script/for.html">for each object</a> 
         loop can access the <var>current_object</var> value. User-defined functions can't 
         take arguments or return values.
      </p>
      <p>
         This code sample creates five skulls and pushes them upward semi-randomly:
      </p>
      <pre><code>
<span class="comment">--</span>
<span class="comment">-- Define the function:</span>
<span class="comment">--</span>
function my_cool_code()
   global.object[1] = global.object[0].place_at_me(skull, none, none, 0, 0, 0, none)
   global.object[1].push_upward()
   global.object[1].push_upward()
end

<span class="comment">--</span>
<span class="comment">-- Call the function five times:</span>
<span class="comment">--</span>
my_cool_code()
my_cool_code()
my_cool_code()
my_cool_code()
my_cool_code()</code></pre>
      
      <h2>Recursion</h2>
      <p>
         User-defined functions can be <dfn>recursive</dfn>: that is, they can call themselves 
         in order to run under specific conditions:
      </p>
      <pre><code>
<span class="comment">--</span>
<span class="comment">-- This function will perform a task "global.number[0]" many times:</span>
<span class="comment">--</span>
function spawn_skulls()
   global.object[1] = global.object[0].place_at_me(skull, none, none, 0, 0, 0, none)
   global.object[1].push_upward()
   global.object[1].push_upward()
   <span class="comment">--</span>
   global.number[0] -= 1
   if global.number[0] &gt; 0 then
      spawn_skulls()
   end
end

<span class="comment">--</span>
<span class="comment">-- Let's spawn ten skulls:</span>
<span class="comment">--</span>
global.number[0] = 10
spawn_skulls()

<span class="comment">--</span>
<span class="comment">-- Let's spawn a random number of skulls:</span>
<span class="comment">--</span>
global.number[0]  = rand(19)
global.number[0] += 1 <span class="comment">-- ensure it's at least one</span>
spawn_skulls()</code></pre>
      <p>
         When writing recursive functions, you need to be careful to ensure that the function 
         actually <em>ends</em>: there must be some circumstance under which the function 
         <em>does not</em> call itself anymore.
      </p>
      <p>
         Megalo doesn't have the ability to loop over a numeric range; however, as shown above, 
         recursive functions can be used as a substitute.
      </p>
      
      <h2>Availability</h2>
      <p>
         User-defined functions are supported by Megalo's bytecode — that is, the format 
         that Megalo is compiled into. However, they did not exist in Bungie's actual design 
         for the Megalo language. Nobody outside of Bungie and 343 Industries has ever seen 
         Megalo in its "true" form, but in the past, Bungie described the language as being 
         similar to BASIC, with no loops, functions, or other jumps. Nested blocks are compiled 
         as disconnected units, with the outer block "calling" the inner block; user-defined 
         functions are just blocks that are called from (or "nested under") multiple places.
      </p>
      <p>
         As such, you won't see user-defined functions in official content, and other 
         community-made tools made for Halo: Reach may fail to handle them properly. As far 
         as I am aware, user-defined functions are entirely new to ReachVariantTool.
      </p>
   
      </main>
      <script src="resources/sidebar.js"></script>
      <script src="resources/header-links.js"></script>
   </body>
</html>